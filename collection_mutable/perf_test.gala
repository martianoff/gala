package main

import (
    "fmt"
    "time"
    . "martianoff/gala/collection_mutable"
)

// Performance test utilities
func measureNs(iterations int, f func() any) int64 {
    var start = time.Now()
    for i := 0; i < iterations; i++ {
        f()
    }
    var elapsed = time.Since(start)
    return elapsed.Nanoseconds() / int64(iterations)
}

func printResult(name string, nsPerOp int64) {
    fmt.Printf("%-45s %12d ns/op\n", name, nsPerOp)
}

// ============ MUTABLE ARRAY BENCHMARKS ============

// Array creation benchmark - small
func benchArrayCreation100() {
    var ns = measureNs(10000, () => {
        var arr = EmptyArray[int]()
        for i := 0; i < 100; i++ {
            arr.Append(i)
        }
    })
    printResult("Array.Creation(100)", ns)
}

// Array creation benchmark - medium
func benchArrayCreation10000() {
    var ns = measureNs(1000, () => {
        var arr = EmptyArray[int]()
        for i := 0; i < 10000; i++ {
            arr.Append(i)
        }
    })
    printResult("Array.Creation(10000)", ns)
}

// Array creation benchmark - large
func benchArrayCreation100000() {
    var ns = measureNs(100, () => {
        var arr = EmptyArray[int]()
        for i := 0; i < 100000; i++ {
            arr.Append(i)
        }
    })
    printResult("Array.Creation(100000)", ns)
}

// Array creation with capacity - medium
func benchArrayCreationWithCapacity10000() {
    var ns = measureNs(1000, () => {
        var arr = ArrayWithCapacity[int](10000)
        for i := 0; i < 10000; i++ {
            arr.Append(i)
        }
    })
    printResult("Array.CreationWithCap(10000)", ns)
}

// Array append benchmark
func benchArrayAppend() {
    var arr = ArrayWithCapacity[int](10001)
    for i := 0; i < 10000; i++ {
        arr.Append(i)
    }
    var ns = measureNs(1000000, () => {
        arr.Append(999)
        arr.RemoveLast()
    })
    printResult("Array.Append (size=10000)", ns)
}

// Array prepend benchmark
func benchArrayPrepend() {
    var arr = ArrayWithCapacity[int](10001)
    for i := 0; i < 10000; i++ {
        arr.Append(i)
    }
    var ns = measureNs(1000, () => {
        arr.Prepend(999)
        arr.RemoveFirst()
    })
    printResult("Array.Prepend (size=10000)", ns)
}

// Array head benchmark
func benchArrayHead() {
    var arr = EmptyArray[int]()
    for i := 0; i < 10000; i++ {
        arr.Append(i)
    }
    var ns = measureNs(10000000, () => {
        var _ = arr.Head()
    })
    printResult("Array.Head (size=10000)", ns)
}

// Array get benchmark - beginning
func benchArrayGetFirst() {
    var arr = EmptyArray[int]()
    for i := 0; i < 10000; i++ {
        arr.Append(i)
    }
    var ns = measureNs(10000000, () => {
        var _ = arr.Get(0)
    })
    printResult("Array.Get(0) (size=10000)", ns)
}

// Array get benchmark - middle
func benchArrayGetMiddle() {
    var arr = EmptyArray[int]()
    for i := 0; i < 10000; i++ {
        arr.Append(i)
    }
    var ns = measureNs(10000000, () => {
        var _ = arr.Get(5000)
    })
    printResult("Array.Get(5000) (size=10000)", ns)
}

// Array get benchmark - end
func benchArrayGetLast() {
    var arr = EmptyArray[int]()
    for i := 0; i < 10000; i++ {
        arr.Append(i)
    }
    var ns = measureNs(10000000, () => {
        var _ = arr.Get(9999)
    })
    printResult("Array.Get(9999) (size=10000)", ns)
}

// Array set benchmark
func benchArraySet() {
    var arr = EmptyArray[int]()
    for i := 0; i < 10000; i++ {
        arr.Append(i)
    }
    var ns = measureNs(10000000, () => {
        arr.Set(5000, 999)
    })
    printResult("Array.Set(5000) (size=10000)", ns)
}

// Array filter benchmark
func benchArrayFilter() {
    var arr = EmptyArray[int]()
    for i := 0; i < 10000; i++ {
        arr.Append(i)
    }
    var ns = measureNs(1000, () => {
        var _ = arr.Filter((x int) => x % 2 == 0)
    })
    printResult("Array.Filter (size=10000)", ns)
}

// Array map benchmark
func benchArrayMap() {
    var arr = EmptyArray[int]()
    for i := 0; i < 10000; i++ {
        arr.Append(i)
    }
    var ns = measureNs(1000, () => {
        var _ = arr.Map((x int) => x * 2)
    })
    printResult("Array.Map (size=10000)", ns)
}

// Array foldLeft benchmark
func benchArrayFoldLeft() {
    var arr = EmptyArray[int]()
    for i := 0; i < 10000; i++ {
        arr.Append(i)
    }
    var ns = measureNs(10000, () => {
        var _ = Array_FoldLeft[int](arr, 0, (acc int, x int) => acc + x)
    })
    printResult("Array.FoldLeft (size=10000)", ns)
}

// Array clone benchmark
func benchArrayClone() {
    var arr = EmptyArray[int]()
    for i := 0; i < 10000; i++ {
        arr.Append(i)
    }
    var ns = measureNs(1000, () => {
        var _ = arr.Clone()
    })
    printResult("Array.Clone (size=10000)", ns)
}

// Array reverse in place benchmark
func benchArrayReverse() {
    var arr = EmptyArray[int]()
    for i := 0; i < 10000; i++ {
        arr.Append(i)
    }
    var ns = measureNs(10000, () => {
        arr.Reverse()
    })
    printResult("Array.Reverse (size=10000)", ns)
}

// ============ MUTABLE LIST BENCHMARKS ============

// List creation benchmark - small
func benchListCreation100() {
    var ns = measureNs(10000, () => {
        var list = EmptyList[int]()
        for i := 0; i < 100; i++ {
            list.Append(i)
        }
    })
    printResult("List.Creation(100)", ns)
}

// List creation benchmark - medium
func benchListCreation10000() {
    var ns = measureNs(1000, () => {
        var list = EmptyList[int]()
        for i := 0; i < 10000; i++ {
            list.Append(i)
        }
    })
    printResult("List.Creation(10000)", ns)
}

// List creation benchmark - large
func benchListCreation100000() {
    var ns = measureNs(100, () => {
        var list = EmptyList[int]()
        for i := 0; i < 100000; i++ {
            list.Append(i)
        }
    })
    printResult("List.Creation(100000)", ns)
}

// List prepend benchmark (O(1))
func benchListPrepend() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(1000000, () => {
        list.Prepend(999)
        list.RemoveFirst()
    })
    printResult("List.Prepend (size=10000)", ns)
}

// List append benchmark (O(1))
func benchListAppend() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(1000000, () => {
        list.Append(999)
        list.RemoveLast()
    })
    printResult("List.Append (size=10000)", ns)
}

// List head benchmark (O(1))
func benchListHead() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(10000000, () => {
        var _ = list.Head()
    })
    printResult("List.Head (size=10000)", ns)
}

// List last benchmark (O(1))
func benchListLast() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(10000000, () => {
        var _ = list.Last()
    })
    printResult("List.Last (size=10000)", ns)
}

// List get benchmark - beginning
func benchListGetFirst() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(100000, () => {
        var _ = list.Get(0)
    })
    printResult("List.Get(0) (size=10000)", ns)
}

// List get benchmark - middle (bidirectional optimization)
func benchListGetMiddle() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(1000, () => {
        var _ = list.Get(5000)
    })
    printResult("List.Get(5000) (size=10000)", ns)
}

// List get benchmark - end (bidirectional optimization)
func benchListGetLast() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(100000, () => {
        var _ = list.Get(9999)
    })
    printResult("List.Get(9999) (size=10000)", ns)
}

// List filter benchmark
func benchListFilter() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(1000, () => {
        var _ = list.Filter((x int) => x % 2 == 0)
    })
    printResult("List.Filter (size=10000)", ns)
}

// List map benchmark
func benchListMap() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(1000, () => {
        var _ = list.Map((x int) => x * 2)
    })
    printResult("List.Map (size=10000)", ns)
}

// List foldLeft benchmark
func benchListFoldLeft() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(10000, () => {
        var _ = List_FoldLeft[int](list, 0, (acc int, x int) => acc + x)
    })
    printResult("List.FoldLeft (size=10000)", ns)
}

// List reverse in place benchmark
func benchListReverse() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(10000, () => {
        list.Reverse()
    })
    printResult("List.Reverse (size=10000)", ns)
}

// List removeFirst/removeLast benchmark
func benchListRemoveFirst() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(1000000, () => {
        list.Prepend(0)
        list.RemoveFirst()
    })
    printResult("List.RemoveFirst (size=10000)", ns)
}

func benchListRemoveLast() {
    var list = EmptyList[int]()
    for i := 0; i < 10000; i++ {
        list.Append(i)
    }
    var ns = measureNs(1000000, () => {
        list.Append(0)
        list.RemoveLast()
    })
    printResult("List.RemoveLast (size=10000)", ns)
}

// ============ MUTABLE HASHSET BENCHMARKS ============

// HashSet creation benchmark - small
func benchHashSetCreation100() {
    var ns = measureNs(10000, () => {
        var s = EmptyHashSet[int]()
        for i := 0; i < 100; i++ {
            s.Add(i)
        }
    })
    printResult("HashSet.Creation(100)", ns)
}

// HashSet creation benchmark - medium
func benchHashSetCreation10000() {
    var ns = measureNs(1000, () => {
        var s = EmptyHashSet[int]()
        for i := 0; i < 10000; i++ {
            s.Add(i)
        }
    })
    printResult("HashSet.Creation(10000)", ns)
}

// HashSet creation benchmark - large
func benchHashSetCreation100000() {
    var ns = measureNs(100, () => {
        var s = EmptyHashSet[int]()
        for i := 0; i < 100000; i++ {
            s.Add(i)
        }
    })
    printResult("HashSet.Creation(100000)", ns)
}

// HashSet add benchmark
func benchHashSetAdd() {
    var s = EmptyHashSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(1000000, () => {
        s.Add(99999)
        s.Remove(99999)
    })
    printResult("HashSet.Add (size=10000)", ns)
}

// HashSet contains benchmark - hit
func benchHashSetContainsHit() {
    var s = EmptyHashSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(10000000, () => {
        var _ = s.Contains(5000)
    })
    printResult("HashSet.Contains hit (size=10000)", ns)
}

// HashSet contains benchmark - miss
func benchHashSetContainsMiss() {
    var s = EmptyHashSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(10000000, () => {
        var _ = s.Contains(99999)
    })
    printResult("HashSet.Contains miss (size=10000)", ns)
}

// HashSet remove benchmark
func benchHashSetRemove() {
    var s = EmptyHashSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(1000000, () => {
        s.Add(99999)
        s.Remove(99999)
    })
    printResult("HashSet.Remove (size=10000)", ns)
}

// HashSet filter benchmark
func benchHashSetFilter() {
    var s = EmptyHashSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(1000, () => {
        var _ = s.Filter((x int) => x % 2 == 0)
    })
    printResult("HashSet.Filter (size=10000)", ns)
}

// HashSet union benchmark
func benchHashSetUnion() {
    var s1 = EmptyHashSet[int]()
    var s2 = EmptyHashSet[int]()
    for i := 0; i < 5000; i++ {
        s1.Add(i)
        s2.Add(i + 2500)
    }
    var ns = measureNs(100, () => {
        var _ = s1.Union(s2)
    })
    printResult("HashSet.Union (size=5000+5000)", ns)
}

// HashSet intersect benchmark
func benchHashSetIntersect() {
    var s1 = EmptyHashSet[int]()
    var s2 = EmptyHashSet[int]()
    for i := 0; i < 5000; i++ {
        s1.Add(i)
        s2.Add(i + 2500)
    }
    var ns = measureNs(100, () => {
        var _ = s1.Intersect(s2)
    })
    printResult("HashSet.Intersect (size=5000+5000)", ns)
}

// HashSet clone benchmark
func benchHashSetClone() {
    var s = EmptyHashSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(1000, () => {
        var _ = s.Clone()
    })
    printResult("HashSet.Clone (size=10000)", ns)
}

// ============ MUTABLE TREESET BENCHMARKS ============

// TreeSet creation benchmark - small
func benchTreeSetCreation100() {
    var ns = measureNs(10000, () => {
        var s = EmptyTreeSet[int]()
        for i := 0; i < 100; i++ {
            s.Add(i)
        }
    })
    printResult("TreeSet.Creation(100)", ns)
}

// TreeSet creation benchmark - medium
func benchTreeSetCreation10000() {
    var ns = measureNs(1000, () => {
        var s = EmptyTreeSet[int]()
        for i := 0; i < 10000; i++ {
            s.Add(i)
        }
    })
    printResult("TreeSet.Creation(10000)", ns)
}

// TreeSet creation benchmark - large
func benchTreeSetCreation100000() {
    var ns = measureNs(100, () => {
        var s = EmptyTreeSet[int]()
        for i := 0; i < 100000; i++ {
            s.Add(i)
        }
    })
    printResult("TreeSet.Creation(100000)", ns)
}

// TreeSet add benchmark
func benchTreeSetAdd() {
    var s = EmptyTreeSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(100000, () => {
        s.Add(99999)
        s.Remove(99999)
    })
    printResult("TreeSet.Add (size=10000)", ns)
}

// TreeSet contains benchmark - hit
func benchTreeSetContainsHit() {
    var s = EmptyTreeSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(1000000, () => {
        var _ = s.Contains(5000)
    })
    printResult("TreeSet.Contains hit (size=10000)", ns)
}

// TreeSet contains benchmark - miss
func benchTreeSetContainsMiss() {
    var s = EmptyTreeSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(1000000, () => {
        var _ = s.Contains(99999)
    })
    printResult("TreeSet.Contains miss (size=10000)", ns)
}

// TreeSet remove benchmark
func benchTreeSetRemove() {
    var s = EmptyTreeSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(100000, () => {
        s.Add(99999)
        s.Remove(99999)
    })
    printResult("TreeSet.Remove (size=10000)", ns)
}

// TreeSet min benchmark
func benchTreeSetMin() {
    var s = EmptyTreeSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(10000000, () => {
        var _ = s.Min()
    })
    printResult("TreeSet.Min (size=10000)", ns)
}

// TreeSet max benchmark
func benchTreeSetMax() {
    var s = EmptyTreeSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(10000000, () => {
        var _ = s.Max()
    })
    printResult("TreeSet.Max (size=10000)", ns)
}

// TreeSet filter benchmark
func benchTreeSetFilter() {
    var s = EmptyTreeSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(1000, () => {
        var _ = s.Filter((x int) => x % 2 == 0)
    })
    printResult("TreeSet.Filter (size=10000)", ns)
}

// TreeSet union benchmark
func benchTreeSetUnion() {
    var s1 = EmptyTreeSet[int]()
    var s2 = EmptyTreeSet[int]()
    for i := 0; i < 5000; i++ {
        s1.Add(i)
        s2.Add(i + 2500)
    }
    var ns = measureNs(100, () => {
        var _ = s1.Union(s2)
    })
    printResult("TreeSet.Union (size=5000+5000)", ns)
}

// TreeSet intersect benchmark
func benchTreeSetIntersect() {
    var s1 = EmptyTreeSet[int]()
    var s2 = EmptyTreeSet[int]()
    for i := 0; i < 5000; i++ {
        s1.Add(i)
        s2.Add(i + 2500)
    }
    var ns = measureNs(100, () => {
        var _ = s1.Intersect(s2)
    })
    printResult("TreeSet.Intersect (size=5000+5000)", ns)
}

// TreeSet range benchmark
func benchTreeSetRange() {
    var s = EmptyTreeSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(1000, () => {
        var _ = s.Range(2500, 7500)
    })
    printResult("TreeSet.Range (size=10000)", ns)
}

// TreeSet clone benchmark
func benchTreeSetClone() {
    var s = EmptyTreeSet[int]()
    for i := 0; i < 10000; i++ {
        s.Add(i)
    }
    var ns = measureNs(1000, () => {
        var _ = s.Clone()
    })
    printResult("TreeSet.Clone (size=10000)", ns)
}

// ============ MUTABLE HASHMAP BENCHMARKS ============

// HashMap creation benchmark - small
func benchHashMapCreation100() {
    var ns = measureNs(10000, () => {
        var m = EmptyHashMap[int, int]()
        for i := 0; i < 100; i++ {
            m.Put(i, i)
        }
    })
    printResult("HashMap.Creation(100)", ns)
}

// HashMap creation benchmark - medium
func benchHashMapCreation10000() {
    var ns = measureNs(1000, () => {
        var m = EmptyHashMap[int, int]()
        for i := 0; i < 10000; i++ {
            m.Put(i, i)
        }
    })
    printResult("HashMap.Creation(10000)", ns)
}

// HashMap creation benchmark - large
func benchHashMapCreation100000() {
    var ns = measureNs(100, () => {
        var m = EmptyHashMap[int, int]()
        for i := 0; i < 100000; i++ {
            m.Put(i, i)
        }
    })
    printResult("HashMap.Creation(100000)", ns)
}

// HashMap put benchmark
func benchHashMapPut() {
    var m = EmptyHashMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000000, () => {
        m.Put(99999, 99999)
        m.Remove(99999)
    })
    printResult("HashMap.Put (size=10000)", ns)
}

// HashMap get benchmark - hit
func benchHashMapGetHit() {
    var m = EmptyHashMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(10000000, () => {
        var _ = m.Get(5000)
    })
    printResult("HashMap.Get hit (size=10000)", ns)
}

// HashMap get benchmark - miss
func benchHashMapGetMiss() {
    var m = EmptyHashMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(10000000, () => {
        var _ = m.Get(99999)
    })
    printResult("HashMap.Get miss (size=10000)", ns)
}

// HashMap contains benchmark - hit
func benchHashMapContainsHit() {
    var m = EmptyHashMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(10000000, () => {
        var _ = m.Contains(5000)
    })
    printResult("HashMap.Contains hit (size=10000)", ns)
}

// HashMap contains benchmark - miss
func benchHashMapContainsMiss() {
    var m = EmptyHashMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(10000000, () => {
        var _ = m.Contains(99999)
    })
    printResult("HashMap.Contains miss (size=10000)", ns)
}

// HashMap remove benchmark
func benchHashMapRemove() {
    var m = EmptyHashMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000000, () => {
        m.Put(99999, 99999)
        m.Remove(99999)
    })
    printResult("HashMap.Remove (size=10000)", ns)
}

// HashMap filter benchmark
func benchHashMapFilter() {
    var m = EmptyHashMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000, () => {
        var _ = m.Filter((k int, v int) => v % 2 == 0)
    })
    printResult("HashMap.Filter (size=10000)", ns)
}

// HashMap mapValues benchmark
func benchHashMapMapValues() {
    var m = EmptyHashMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000, () => {
        var _ = m.MapValues[int]((v int) => v * 2)
    })
    printResult("HashMap.MapValues (size=10000)", ns)
}

// HashMap clone benchmark
func benchHashMapClone() {
    var m = EmptyHashMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000, () => {
        var _ = m.Clone()
    })
    printResult("HashMap.Clone (size=10000)", ns)
}

// HashMap string keys benchmark
func benchHashMapStringKeys() {
    var m = EmptyHashMap[string, int]()
    var keys []string
    for i := 0; i < 10000; i++ {
        var key = "key" + string(rune(i%26+65)) + string(rune((i/26)%26+65))
        keys = append(keys, key)
        m.Put(key, i)
    }
    var ns = measureNs(1000000, () => {
        var _ = m.Get(keys[5000])
    })
    printResult("HashMap.Get string key (size=10000)", ns)
}

// ============ MUTABLE TREEMAP BENCHMARKS ============

// TreeMap creation benchmark - small
func benchTreeMapCreation100() {
    var ns = measureNs(10000, () => {
        var m = EmptyTreeMap[int, int]()
        for i := 0; i < 100; i++ {
            m.Put(i, i)
        }
    })
    printResult("TreeMap.Creation(100)", ns)
}

// TreeMap creation benchmark - medium
func benchTreeMapCreation10000() {
    var ns = measureNs(1000, () => {
        var m = EmptyTreeMap[int, int]()
        for i := 0; i < 10000; i++ {
            m.Put(i, i)
        }
    })
    printResult("TreeMap.Creation(10000)", ns)
}

// TreeMap creation benchmark - large
func benchTreeMapCreation100000() {
    var ns = measureNs(100, () => {
        var m = EmptyTreeMap[int, int]()
        for i := 0; i < 100000; i++ {
            m.Put(i, i)
        }
    })
    printResult("TreeMap.Creation(100000)", ns)
}

// TreeMap put benchmark
func benchTreeMapPut() {
    var m = EmptyTreeMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(100000, () => {
        m.Put(99999, 99999)
        m.Remove(99999)
    })
    printResult("TreeMap.Put (size=10000)", ns)
}

// TreeMap get benchmark - hit
func benchTreeMapGetHit() {
    var m = EmptyTreeMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000000, () => {
        var _ = m.Get(5000)
    })
    printResult("TreeMap.Get hit (size=10000)", ns)
}

// TreeMap get benchmark - miss
func benchTreeMapGetMiss() {
    var m = EmptyTreeMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000000, () => {
        var _ = m.Get(99999)
    })
    printResult("TreeMap.Get miss (size=10000)", ns)
}

// TreeMap contains benchmark - hit
func benchTreeMapContainsHit() {
    var m = EmptyTreeMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000000, () => {
        var _ = m.Contains(5000)
    })
    printResult("TreeMap.Contains hit (size=10000)", ns)
}

// TreeMap contains benchmark - miss
func benchTreeMapContainsMiss() {
    var m = EmptyTreeMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000000, () => {
        var _ = m.Contains(99999)
    })
    printResult("TreeMap.Contains miss (size=10000)", ns)
}

// TreeMap remove benchmark
func benchTreeMapRemove() {
    var m = EmptyTreeMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(100000, () => {
        m.Put(99999, 99999)
        m.Remove(99999)
    })
    printResult("TreeMap.Remove (size=10000)", ns)
}

// TreeMap minKey benchmark
func benchTreeMapMinKey() {
    var m = EmptyTreeMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(10000000, () => {
        var _ = m.MinKey()
    })
    printResult("TreeMap.MinKey (size=10000)", ns)
}

// TreeMap maxKey benchmark
func benchTreeMapMaxKey() {
    var m = EmptyTreeMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(10000000, () => {
        var _ = m.MaxKey()
    })
    printResult("TreeMap.MaxKey (size=10000)", ns)
}

// TreeMap range benchmark
func benchTreeMapRange() {
    var m = EmptyTreeMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000, () => {
        var _ = m.Range(2500, 7500)
    })
    printResult("TreeMap.Range (size=10000)", ns)
}

// TreeMap filter benchmark
func benchTreeMapFilter() {
    var m = EmptyTreeMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000, () => {
        var _ = m.Filter((k int, v int) => v % 2 == 0)
    })
    printResult("TreeMap.Filter (size=10000)", ns)
}

// TreeMap mapValues benchmark
func benchTreeMapMapValues() {
    var m = EmptyTreeMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000, () => {
        var _ = m.MapValues[int]((v int) => v * 2)
    })
    printResult("TreeMap.MapValues (size=10000)", ns)
}

// TreeMap putFrom benchmark
func benchTreeMapPutFrom() {
    var m1 = EmptyTreeMap[int, int]()
    var m2 = EmptyTreeMap[int, int]()
    for i := 0; i < 1000; i++ {
        m1.Put(i, i)
        m2.Put(i + 500, i + 500)
    }
    var ns = measureNs(100, () => {
        var clone = m1.Clone()
        clone.PutFrom(m2)
    })
    printResult("TreeMap.PutFrom (2x1000)", ns)
}

// TreeMap clone benchmark
func benchTreeMapClone() {
    var m = EmptyTreeMap[int, int]()
    for i := 0; i < 10000; i++ {
        m.Put(i, i)
    }
    var ns = measureNs(1000, () => {
        var _ = m.Clone()
    })
    printResult("TreeMap.Clone (size=10000)", ns)
}

func main() {
    fmt.Println("=== GALA Mutable Collections Performance ===")
    fmt.Println("Testing with 100 - 100,000 elements")
    fmt.Println("")

    fmt.Println("--- Array Operations ---")
    benchArrayCreation100()
    benchArrayCreation10000()
    benchArrayCreation100000()
    benchArrayCreationWithCapacity10000()
    benchArrayAppend()
    benchArrayPrepend()
    benchArrayHead()
    benchArrayGetFirst()
    benchArrayGetMiddle()
    benchArrayGetLast()
    benchArraySet()
    benchArrayFilter()
    benchArrayMap()
    benchArrayFoldLeft()
    benchArrayClone()
    benchArrayReverse()

    fmt.Println("")
    fmt.Println("--- List Operations ---")
    benchListCreation100()
    benchListCreation10000()
    benchListCreation100000()
    benchListPrepend()
    benchListAppend()
    benchListHead()
    benchListLast()
    benchListGetFirst()
    benchListGetMiddle()
    benchListGetLast()
    benchListFilter()
    benchListMap()
    benchListFoldLeft()
    benchListReverse()
    benchListRemoveFirst()
    benchListRemoveLast()

    fmt.Println("")
    fmt.Println("--- HashSet Operations (Hash-based) ---")
    benchHashSetCreation100()
    benchHashSetCreation10000()
    benchHashSetCreation100000()
    benchHashSetAdd()
    benchHashSetContainsHit()
    benchHashSetContainsMiss()
    benchHashSetRemove()
    benchHashSetFilter()
    benchHashSetUnion()
    benchHashSetIntersect()
    benchHashSetClone()

    fmt.Println("")
    fmt.Println("--- TreeSet Operations (Red-Black Tree) ---")
    benchTreeSetCreation100()
    benchTreeSetCreation10000()
    benchTreeSetCreation100000()
    benchTreeSetAdd()
    benchTreeSetContainsHit()
    benchTreeSetContainsMiss()
    benchTreeSetRemove()
    benchTreeSetMin()
    benchTreeSetMax()
    benchTreeSetFilter()
    benchTreeSetUnion()
    benchTreeSetIntersect()
    benchTreeSetRange()
    benchTreeSetClone()

    fmt.Println("")
    fmt.Println("--- HashMap Operations (Hash-based) ---")
    benchHashMapCreation100()
    benchHashMapCreation10000()
    benchHashMapCreation100000()
    benchHashMapPut()
    benchHashMapGetHit()
    benchHashMapGetMiss()
    benchHashMapContainsHit()
    benchHashMapContainsMiss()
    benchHashMapRemove()
    benchHashMapFilter()
    benchHashMapMapValues()
    benchHashMapClone()
    benchHashMapStringKeys()

    fmt.Println("")
    fmt.Println("--- TreeMap Operations (Red-Black Tree) ---")
    benchTreeMapCreation100()
    benchTreeMapCreation10000()
    benchTreeMapCreation100000()
    benchTreeMapPut()
    benchTreeMapGetHit()
    benchTreeMapGetMiss()
    benchTreeMapContainsHit()
    benchTreeMapContainsMiss()
    benchTreeMapRemove()
    benchTreeMapMinKey()
    benchTreeMapMaxKey()
    benchTreeMapRange()
    benchTreeMapFilter()
    benchTreeMapMapValues()
    benchTreeMapPutFrom()
    benchTreeMapClone()
}
